"use strict";(self.webpackChunkwebpack_config=self.webpackChunkwebpack_config||[]).push([[560],{43455:(e,n,t)=>{t.d(n,{Z:()=>v});t(67294);var r=t(80411),i=t.n(r),a=t(31298),s=t(31660);const c="index__container--DASxH",o="index__wrap--zMp8f",l="index__scrollWrap--GYu0y",d="index__scrollBar--jWRjC",u="index__dark--aoQki",m="index__hideWrapPadding--xINbC",h="index__contentWidth--csdpd",x="index__showContainer--mFO7k",f="index__darkContainer--j8WUx";var p=t(85893);const v=function(e){var n=e.children,t=e.className,r=e.containerClassName,v=e.wrapClassName,_=e.onScroll,j=e.scrollbarRef,g=e.contentWrapRef,N=e.autoHeight,I=e.autoHeightMax,b=e.themeMode,k=(0,s.Jg)().siderVisible,w=(0,s.nR)().htmlWidth;return(0,p.jsx)("div",{className:i()(c,r,k&&w>960&&x,"dark"===b&&f),children:(0,p.jsx)("div",{className:i()(o,v,k&&w>960&&m),ref:g,children:(0,p.jsx)("div",{className:i()(l,t,k&&w>960&&h,"dark"===b&&u),children:(0,p.jsx)(a.$B,{autoHide:!0,autoHeight:N,autoHeightMax:I,ref:j,className:d,onScrollFrame:_,children:n})})})})}},68281:(e,n,t)=>{t.d(n,{Z:()=>G});var r=t(67294),i=t(80411),a=t.n(i),s=(t(34935),t(71577)),c=t(15861),o=t(29439),l=t(64687),d=t.n(l),u=t(96974),m=t(49058),h=t(81237),x=t(95717),f=t(20555);const p="index__needMarginBottom--jbdK1",v="index__introductionWrap--cRwkD",_="index__card--a148g",j="index__image--Sgd5D",g="index__nameInfo--i1Khy",N="index__name--vu0aO",I="index__desc--Q1SrY",b="index__articleInfo--ExCKV",k="index__statistical--rThMZ",w="index__articleTotal--kFXGi",y="index__socialWrap--RwYKS",C="index__link--ctC90",Z="index__github--srJ9b",O="index__socialList--_k5Qr",S="index__dark--VmH3q";var T=t(85893);const W=function(e){var n=e.className,t=e.showRecommendArticle,i=e.themeMode,l=(0,r.useState)({userId:""}),W=(0,o.Z)(l,2),P=W[0],A=W[1],E=(0,u.s0)();(0,r.useEffect)((function(){L()}),[]);var L=function(){var e=(0,c.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=f.wg,e.next=3,x.bG({auth:1,needTotal:!0});case 3:e.t1=e.sent,(n=(0,e.t0)(e.t1)).success&&A(n.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return P.userId?(0,T.jsxs)("div",{className:a()(v,n,t&&p,"dark"===i&&S),children:[(0,T.jsx)("div",{className:_,children:(0,T.jsx)(h.Z,{url:(null==P?void 0:P.headUrl)||m.Hn,transitionImg:m.Hn,className:j,onClick:function(){E("/author")}})}),(0,T.jsxs)("div",{className:g,children:[(0,T.jsx)("div",{className:N,children:null==P?void 0:P.username}),(0,T.jsx)("div",{suppressContentEditableWarning:!0,contentEditable:"true",className:I,title:null==P?void 0:P.motto,children:null==P?void 0:P.motto})]}),(0,T.jsx)("div",{className:b,children:(0,T.jsxs)("div",{className:k,children:["共发表",(0,T.jsx)("span",{className:w,children:null==P?void 0:P.articleTotal}),"篇文章"]})}),(0,T.jsxs)("div",{className:y,children:[(0,T.jsx)("a",{href:"http://".concat(m.R4,":8090"),target:"_blank",rel:"noreferrer",className:C,children:"墨客管理后台"}),(0,T.jsx)(s.Z,{className:Z,type:"primary",onClick:function(){null!=P&&P.github?window.open(null==P?void 0:P.github):(0,f.um)("还没设置github地址")},children:"GitHub"}),(0,T.jsxs)("div",{className:O,children:[(null==P?void 0:P.juejin)&&(0,T.jsx)("span",{onClick:function(){null!=P&&P.juejin?window.open(null==P?void 0:P.juejin):(0,f.um)("还没设置掘金地址")},children:"掘金"}),(null==P?void 0:P.zhihu)&&(0,T.jsx)("span",{onClick:function(){null!=P&&P.juejin?window.open(null==P?void 0:P.zhihu):(0,f.um)("还没设置知乎地址")},children:"知乎"}),(null==P?void 0:P.blog)&&(0,T.jsx)("span",{onClick:function(){null!=P&&P.juejin?window.open(null==P?void 0:P.blog):(0,f.um)("还没设置博客地址")},children:"博客"})]})]})]}):null};var P=t(19674),A=t(31660),E=t(96186);const L="index__NewArticles--lkils",M="index__contant--TGks6",U="index__header--AUZK9",R="index__item--ggSOn",D="index__title--Mqzb4",H="index__abstract--ofaGV",B="index__likeCount--wgUPL",z="index__dark--X2Shr",F="index__itemDark--wpYy9",V="index__ipcWrap--Q4Jds",q="index__changeTop--tkX85";const J=function(e){var n=e.scrollRef,t=e.themeMode,i=e.htmlWidth,s=void 0===i?0:i,l=(0,r.useState)([]),m=(0,o.Z)(l,2),h=m[0],p=m[1],v=(0,u.s0)(),_=(0,P.Z)().userInfoStore.getUserInfo,j=(0,A.Jg)().siderVisible;(0,r.useEffect)((function(){g()}),[]);var g=function(){var e=(0,c.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=E.w,e.next=3,x.un({userId:null==_?void 0:_.userId});case 3:e.t1=e.sent,(n=(0,e.t0)(e.t1)).success?p(n.data):(0,f.vU)(n.message);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,T.jsxs)("div",{className:a()(L,j&&s>960&&q,"dark"===t&&z),ref:n,children:[(0,T.jsxs)("div",{className:a()(M,"dark"===t&&z),children:[(0,T.jsx)("div",{className:a()(U,"dark"===t&&z),children:"文章推荐"}),h.length>0&&h.map((function(e){return(0,T.jsxs)("div",{className:a()(R,"dark"===t&&F),onClick:function(){return n=e.id,void v("/detail/".concat(n));var n},children:[(0,T.jsx)("div",{className:D,children:e.title}),(0,T.jsxs)("div",{className:H,children:[(0,T.jsx)("span",{children:(0,f.fg)(e.createTime)}),(null==e?void 0:e.likeCount)>0&&(0,T.jsxs)("span",{className:B,children:[e.likeCount," 点赞"]})]})]},e.id)}))]}),j&&(0,T.jsx)("div",{className:V,children:(0,T.jsx)("a",{href:"https://beian.miit.gov.cn/",target:"_blank",rel:"noreferrer",children:"浙ICP备2024111222号-1"})})]})},K="index__container--j1TfK";const G=function(e){var n=e.className,t=e.showRecommendArticle,r=e.scrollRef,i=e.themeMode,s=e.htmlWidth,c=void 0===s?0:s;return c>960?(0,T.jsxs)("div",{className:a()(K,n),children:[(0,T.jsx)(W,{showRecommendArticle:t,themeMode:i}),t&&(0,T.jsx)(J,{scrollRef:r,themeMode:i,htmlWidth:c})]}):null}},46380:(e,n,t)=>{t.d(n,{Z:()=>I});t(41958);var r=t(46072),i=(t(15692),t(29759)),a=t(15861),s=t(29439),c=t(64687),o=t.n(c),l=t(67294),d=t(42016),u=t(49101),m=t(80411),h=t.n(m),x=t(74317),f=t(81237),p=t(95717),v=t(19674),_=t(20555),j=t(49058);const g={clickNoSelectText:"index__clickNoSelectText--sBjh1",Upload:"index__Upload--X2jAF",uploadImgWrap:"index__uploadImgWrap--Ubp2a",mark:"index__mark--c7H4B",iconWrap:"index__iconWrap--oiei1",iconLeft:"index__iconLeft--Kmk_q",imgStyle:"index__imgStyle--Fztw3",imageWrapStyle:"index__imageWrapStyle--dE9ww"};var N=t(85893);const I=function(e){var n=e.formLabel,t=e.needPreview,c=void 0===t||t,m=e.filePath,I=e.transitionImg,b=e.form,k=e.setFilePath,w=e.imgStyle,y=e.markStyle,C=e.uploadWrapStyle,Z=e.setAlertStatus,O=e.aspectRatio,S=void 0===O?1:O,T=e.uploadStyle,W=e.uploadNode,P=e.listType,A=void 0===P?"picture-card":P,E=e.getUploadFilePath,L=e.deleteOldCoverImage,M=(0,l.useState)(!1),U=(0,s.Z)(M,2),R=U[0],D=U[1],H=(0,l.useState)(!1),B=(0,s.Z)(H,2),z=B[0],F=B[1],V=(0,l.useState)({url:"",filename:"",type:""}),q=(0,s.Z)(V,2),J=q[0],K=q[1],G=(0,l.useRef)(null),Q=(0,v.Z)().userInfoStore.getUserInfo,Y=function(){var e=(0,a.Z)(o().mark((function e(n){var t,r,i,a,s,c,l,d,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.type,i=n.size/1024/1024<20,j.nz.includes(r)||(0,_.vU)(j.Vo),i||(0,_.vU)("请上传小于20M的图片"),e.next=6,(0,_.hw)(n);case 6:return a=e.sent,s=null==n||null===(t=n.name)||void 0===t?void 0:t.lastIndexOf("."),c=n.name.slice(s+1),l=new File([n],"".concat(a,"_").concat(Q.userId,".").concat(c),{type:n.type}),d=new FileReader,u=new Image,d.readAsDataURL(l),d.onload=function(e){u.src=d.result,u.onload=function(){var n;K({url:null===(n=e.target)||void 0===n?void 0:n.result,filename:l.name,type:l.type}),F(!0)}},e.abrupt("return",j.nz.includes(r)&&i);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,N.jsxs)("div",{className:h()(T,g.Upload),children:[z&&(0,N.jsx)(i.Z,{title:"请选择剪裁区域",className:g.cropperModalWrap,visible:z,width:820,onCancel:function(){return F(!1)},onOk:function(){G.current&&G.current.getCroppedCanvas().toBlob(function(){var e=(0,a.Z)(o().mark((function e(t){var r,i,a,s,l,d,u,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_.hv)({file:t,quality:.5,mimeType:J.type});case 2:return r=e.sent,i=r.file,(a=new FormData).append("file",i,J.filename),e.t0=_.wg,e.next=9,p.cT(a);case 9:e.t1=e.sent,s=(0,e.t0)(e.t1),F(!1),s.success&&(k&&k(null==s||null===(l=s.data)||void 0===l?void 0:l.filePath),null==b||b.setFieldsValue(n?{mainCover:null==s||null===(d=s.data)||void 0===d?void 0:d.filePath}:{coverImage:null==s||null===(u=s.data)||void 0===u?void 0:u.filePath}),E&&E(null==s||null===(m=s.data)||void 0===m?void 0:m.filePath,c),(0,_.Vp)(s.message)),s.success||409!==s.code||Z&&Z(!0),s.success||409===s.code||401===s.code||(0,_.vU)(s.message);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())},children:(0,N.jsx)(d.Z,{src:J.url,ref:G,onInitialized:function(e){G.current=e},preview:".uploadCrop",viewMode:1,zoomable:!0,type:"image/jpeg",guides:!1,background:!1,rotatable:!1,autoCropArea:1,style:{width:"auto",height:"100%"},aspectRatio:S,cropBoxResizable:!0,cropBoxMovable:!0,dragMode:"move",center:!0})}),(0,N.jsx)(r.Z,{name:"file",headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("token"))},listType:A,showUploadList:!1,beforeUpload:Y,customRequest:function(){},children:W||!m&&(0,N.jsx)(u.Z,{})}),!W&&m&&(0,N.jsxs)("div",{className:h()(C,g.uploadImgWrap),children:[(0,N.jsxs)("div",{className:h()(y,g.mark),children:[c&&(0,N.jsx)(x.Z,{name:"icon-browse",className:h()(g.iconWrap,g.iconLeft),onClick:function(){D(!0)}}),(0,N.jsx)(x.Z,{name:"icon-shanchu",className:g.iconWrap,onClick:function(){null==L||L(),k&&k("")}})]}),(0,N.jsx)(f.Z,{url:m,transitionImg:I,className:w,imageWrapStyle:g.imageWrapStyle})]}),c&&m&&(0,N.jsx)(i.Z,{visible:R,centered:!0,closable:!1,width:600,footer:null,onCancel:function(){D(!1)},children:(0,N.jsx)(f.Z,{url:m,transitionImg:I,className:g.imgStyle})})]})}},87489:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Zt});t(40097);var r=t(11382),i=(t(47887),t(95140)),a=(t(27138),t(44311)),s=(t(34935),t(71577)),c=t(29439),o=t(67294),l=t(39711),d=t(96974),u=t(80411),m=t.n(u),h=t(26139),x=t(4942),f=t(44925),p=t(18093),v=t(53961),_=t(79166),j=t(40333),g=t(12725),N=t(65025),I=t(33501);const b="index__container--Gb7g3",k="index__coverImg--wdBHM",w="index__blockquote--cWZtY",y="index__header_H--RZltU";var C=t(85893),Z=["children","level"],O=["node","inline","className","children"],S=["node","children","level"],T=["node","children","level"],W=["node","children","level"],P=["node","children","level"],A=["node","children","level"],E=["node","children","level"],L=["node"];function M(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function U(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?M(Object(t),!0).forEach((function(n){(0,x.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):M(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const R=function(e){var n=e.mackdown,t=e.className,r=e.children,i=e.coverImg,a=(0,o.useRef)(null),s=function(e){var n=e.children,t=e.level,r=(0,f.Z)(e,Z);switch(t){case 1:return(0,C.jsx)("h1",U(U({},r),{},{className:y,children:n}));case 2:return(0,C.jsx)("h2",U(U({},r),{},{className:y,children:n}));case 3:default:return(0,C.jsx)("h3",U(U({},r),{},{className:y,children:n}));case 4:return(0,C.jsx)("h4",U(U({},r),{},{className:y,children:n}));case 5:return(0,C.jsx)("h5",U(U({},r),{},{className:y,children:n}));case 6:return(0,C.jsx)("h6",U(U({},r),{},{className:y,children:n}))}};return(0,C.jsxs)("div",{className:m()(b,t),ref:a,children:[(0,C.jsx)("div",{className:k,children:i}),(0,C.jsx)(p.D,{children:n,remarkPlugins:[[j.Z,{singleTilde:!1}],g.Z],rehypePlugins:[N.Z,I.Z],components:{code:function(e){e.node;var n=e.inline,t=e.className,r=e.children,i=(0,f.Z)(e,O),a=/language-(\w+)/.exec(t||"");return!n&&a?(0,C.jsx)(v.Z,U({children:String(r).replace(/\n$/,""),style:_.Z,language:a[1],PreTag:"div"},i)):(0,C.jsx)("code",U(U({className:t},i),{},{children:r}))},h1:function(e){e.node;var n=e.children,t=e.level,r=(0,f.Z)(e,S);return s(U({children:n,level:t},r))},h2:function(e){e.node;var n=e.children,t=e.level,r=(0,f.Z)(e,T);return s(U({children:n,level:t},r))},h3:function(e){e.node;var n=e.children,t=e.level,r=(0,f.Z)(e,W);return s(U({children:n,level:t},r))},h4:function(e){e.node;var n=e.children,t=e.level,r=(0,f.Z)(e,P);return s(U({children:n,level:t},r))},h5:function(e){e.node;var n=e.children,t=e.level,r=(0,f.Z)(e,A);return s(U({children:n,level:t},r))},h6:function(e){e.node;var n=e.children,t=e.level,r=(0,f.Z)(e,E);return s(U({children:n,level:t},r))},blockquote:function(e){e.node;var n=(0,f.Z)(e,L);return(0,C.jsx)("blockquote",U({className:w},n))}}}),r]})};var D=t(10814),H=t(81237),B=(t(17823),t(19181)),z=t(15861),F=t(64687),V=t.n(F),q=t(19674),J=t(95717),K=t(96186),G=t(20555),Q=t(92592);const Y="index__Qrcode--HNhJD";const X=function(){var e=(0,o.useRef)(null);return(0,o.useEffect)((function(){Q.toCanvas(window.location.href,{errorCorrectionLevel:"H",margin:1,width:100},(function(n,t){var r;if(n)throw n;null===(r=e.current)||void 0===r||r.appendChild(t)}))}),[e]),(0,C.jsxs)("div",{className:Y,children:[(0,C.jsx)("div",{ref:e}),(0,C.jsx)("div",{children:"微信扫码分享"})]})};var $=t(31660),ee=t(36762),ne=t(90078),te=t(74317),re=t(45015),ie=t(14110),ae=t(82867);const se="index__Multibar--v1CqB",ce="index__actionBtn--eEunu",oe="index__actionIcon--rcCNi",le="index__likeActionIcon--OJW7b",de="index__collectedIcon--hr80Q",ue="index__commentIcon--oPssC",me="index__collectionIcon--qnUaH",he="index__shareIcon--b1dAq",xe="index__likeCount--xLvd3",fe="index__shareOverlayClassName--lVbuV",pe="index__darkShareOverlayClassName--acJmv",ve="index__shareContent--HVaSO",_e="index__wechart--eChsK",je="index__weibo--BLY_F",ge="index__shareQZon--CpQBJ",Ne="index__weiboIcon--rKVKR",Ie="index__wechartIcon--LJgd0",be="index__qqIcon--aLkwI",ke="index__overlayClassName--B3gLh",we="index__dark--LdjP1";function ye(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Ce(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ye(Object(t),!0).forEach((function(n){(0,x.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ye(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const Ze=function(e){var n=e.id,t=e.detail,r=e.commentRef,i=e.themeMode,a=(0,o.useState)(0),s=(0,c.Z)(a,2),l=s[0],u=s[1],h=(0,o.useState)(!1),x=(0,c.Z)(h,2),f=x[0],p=x[1],v=(0,o.useState)(!1),_=(0,c.Z)(v,2),j=_[0],g=_[1],N=(0,o.useState)(!1),I=(0,c.Z)(N,2),b=I[0],k=I[1],w=(0,o.useState)(!1),y=(0,c.Z)(w,2),Z=y[0],O=y[1],S=(0,o.useState)(""),T=(0,c.Z)(S,2),W=T[0],P=T[1],A=(0,o.useState)(0),E=(0,c.Z)(A,2),L=E[0],M=E[1],U=(0,d.TH)(),R=U.pathname,D=U.search,H=(0,$.vV)(!0,!1,!0).loginStatus,F=(0,o.useRef)(null);(0,o.useEffect)((function(){ee.N.onSetCommentCount.listen((function(){var e=ee.N.commentCount;M(e)}))}),[]);var Q=(0,q.Z)().userInfoStore.getUserInfo;(0,o.useEffect)((function(){u(null==t?void 0:t.likeCount),p(null==t?void 0:t.isLike)}),[t]),(0,o.useEffect)((function(){j||(Se(),Te())}),[j,n,H]);var Y=function(){F.current&&(clearInterval(F.current),F.current=null),F.current=setTimeout((function(){(0,ne.x)()}),5e3)},ye=function(e){if((null==Q?void 0:Q.userId)!==(null==t?void 0:t.authorId)){var r=Ce({},t);delete r.content,(0,ae.bG)(JSON.stringify({action:"push",data:Ce(Ce({},r),{},{articleId:n,toUserId:null==r?void 0:r.authorId,fromUsername:null==Q?void 0:Q.username,fromUserId:null==Q?void 0:Q.userId,action:e}),userId:null==Q?void 0:Q.userId}))}},Ze=function(){var e=(0,z.Z)(V().mark((function e(){var t;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:if(null!=Q&&Q.userId&&H.success){e.next=6;break}return(0,ne.$)({pathname:R,search:D}),Y(),e.abrupt("return");case 6:return e.t0=K.w,e.next=9,J.HA({id:n,userId:null==Q?void 0:Q.userId});case 9:if(e.t1=e.sent,(t=(0,e.t0)(e.t1)).success){e.next=14;break}return 401!==t.code&&((0,ne.$)({pathname:R,search:D}),Y()),e.abrupt("return");case 14:p(t.data.isLike),u(t.data.likeCount),ye(t.data.isLike?"LIKE_ARTICLE":"CANCEL_LIKE_ARTICLE");case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oe=function(){if(null==Q||!Q.userId||!H.success)return(0,ne.$)({pathname:R,search:D}),void Y();g(!0)},Se=function(){var e=(0,z.Z)(V().mark((function e(){var t;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=Q&&Q.userId&&H.success){e.next=2;break}return e.abrupt("return");case 2:return e.t0=K.w,e.next=5,J.DA({articleId:n,userId:null==Q?void 0:Q.userId});case 5:e.t1=e.sent,(t=(0,e.t0)(e.t1)).success&&O(t.data.collected);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Te=function(){var e=(0,z.Z)(V().mark((function e(){var t;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=K.w,e.next=3,J.Bi({id:n,userId:null==Q?void 0:Q.userId});case 3:e.t1=e.sent,(t=(0,e.t0)(e.t1)).success&&p(t.data.isLike);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),We=function(){var e=(0,z.Z)(V().mark((function e(){var t;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=Q&&Q.userId&&H.success){e.next=4;break}return(0,ne.$)({pathname:R,search:D}),Y(),e.abrupt("return");case 4:return e.t0=K.w,e.next=7,J.WH({articleId:n,userId:null==Q?void 0:Q.userId});case 7:e.t1=e.sent,(t=(0,e.t0)(e.t1)).success?(Se(),ye("CANCEL_COLLECT")):409===t.code?((0,ne.$)({pathname:R,search:D}),Y()):(0,G.vU)(t.message);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pe=(0,C.jsxs)("div",{className:ve,children:[(0,C.jsx)(B.Z,{placement:"top",trigger:"hover",getPopupContainer:function(e){return e},content:(0,C.jsx)(X,{}),overlayClassName:"dark"===i?ke:"",children:(0,C.jsxs)("div",{className:_e,children:[(0,C.jsx)("div",{children:(0,C.jsx)(te.Z,{name:"icon-weixin1",className:Ie})}),(0,C.jsx)("span",{children:"微信"})]})}),(0,C.jsxs)("div",{className:je,onClick:function(){return(0,G.zv)(null==t?void 0:t.title,null==t?void 0:t.coverImage)},children:[(0,C.jsx)("div",{children:(0,C.jsx)(te.Z,{name:"icon-xinlangweibo",className:Ne,noStopPropagation:!0})}),(0,C.jsx)("span",{children:"新浪微博"})]}),(0,C.jsxs)("div",{className:ge,onClick:function(){return(0,G.xq)(null==t?void 0:t.title,null==t?void 0:t.coverImage)},children:[(0,C.jsx)("div",{children:(0,C.jsx)(te.Z,{name:"icon-qq",className:be,noStopPropagation:!0})}),(0,C.jsx)("span",{children:"QQ"})]})]});return(0,C.jsxs)("div",{className:m()(se,"dark"===i&&we),children:[(0,C.jsxs)("div",{className:ce,children:[(0,C.jsx)(te.Z,{name:"icon-24gf-thumbsUp2",className:m()(oe,f&&le),onClick:Ze,customStyle:!0}),l>0&&(0,C.jsx)("span",{className:xe,children:l})]}),(0,C.jsxs)("div",{className:ce,children:[(0,C.jsx)(te.Z,{name:"icon-pinglun1",className:ue,onClick:function(){if(r.current){var e=r.current.offsetTop;document.documentElement.scrollTop=e}},customStyle:!0}),L>0&&(0,C.jsx)("span",{className:xe,children:L>999?(0,C.jsx)("span",{title:L&&JSON.stringify(L)||"",children:"999+"}):L})]}),(0,C.jsx)("div",{className:ce,children:(0,C.jsx)(te.Z,{name:"icon-31shoucangxuanzhong",className:m()(me,Z&&de),onClick:Z?We:Oe,customStyle:!0})}),(0,C.jsx)(B.Z,{placement:"rightTop",trigger:"hover",getPopupContainer:function(e){return e.parentNode},content:Pe,overlayClassName:m()(fe,"dark"===i&&pe),children:(0,C.jsx)("div",{className:ce,children:(0,C.jsx)(te.Z,{name:"icon-tiaoguofenxiang",className:he,customStyle:!0})})}),(0,C.jsx)(re.Z,{visible:j,onCancel:function(){g(!1),P("")},getAddVisible:function(e){k(e)},createCollectId:W,themeMode:i,sendMsg:ye}),(0,C.jsx)(ie.Z,{visible:b,onCancel:function(){return k(!1)},showCollection:Oe,getCreateCollectId:function(e){P(e)},themeMode:i},Math.random())]})};var Oe=t(92540),Se=t(49058),Te=t(68281),We=t(33977),Pe=t(31298);const Ae="index__tocWrap--aCRzI",Ee="index__mackNav--UJRsK",Le="index__scrollbar--U4Mqw",Me="index__tocText--pITUc",Ue="index__tocList--nz_2R",Re="index__dark--QLSmw";function De(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function He(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?De(Object(t),!0).forEach((function(n){(0,x.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):De(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const Be=function(e){var n=e.mackdown,t=e.className,r=e.themeMode,i=(0,o.useRef)();(0,o.useEffect)((function(){if(!i||i.current)return window.addEventListener("scroll",a),function(){window.removeEventListener("scroll",a)}}),[i]);var a=function(){var e,n,t,r,a=null==i||null===(e=i.current)||void 0===e?void 0:e.getScrollHeight(),s=null===(n=document.documentElement)||void 0===n?void 0:n.scrollTop,c=a/(null===(t=document.documentElement)||void 0===t?void 0:t.scrollHeight)*s;null==i||null===(r=i.current)||void 0===r||r.scrollTop(c)};return n.includes("#")?(0,C.jsxs)("div",{className:m()(Ae,t,"dark"===r&&Re),children:[(0,C.jsx)("div",{className:Me,children:"文章目录"}),(0,C.jsx)("div",{className:Ee,children:(0,C.jsx)(Pe.$B,{autoHide:!0,ref:i,renderThumbVertical:function(){return(0,C.jsx)("div",{style:He({},{backgroundColor:"rgba(225, 225, 225, 0)"})})},autoHeight:!0,autoHeightMax:"calc(100vh - 124px)",className:Le,children:(0,C.jsx)(We.ZP,{className:Ue,source:n,headingTopOffset:60,declarative:!1,ordered:!0})})})]}):null};t(15692);var ze=t(29759),Fe=t(93433),Ve=t(29191),qe=(t(37796),t(24044));const Je="index__Emoji--OQFph",Ke="index__emojiItem--Ooz0S",Ge="index__emoji--Qgfpf";const Qe=function(e){var n=e.addEmoji,t=e.setVisible,r=function(e){return function(){n(e),t(!1)}};return(0,C.jsx)("div",{id:"_emoji_",className:Je,children:Se.Dn.map((function(e,n){return(0,C.jsx)("div",{className:Ke,onClick:r(e),id:e,children:(0,C.jsx)("img",{src:"".concat(Se.qt).concat(Se.rr[e]),alt:"",className:Ge,id:"emoji_".concat(e)},n)},e)}))})};var Ye=t(46380);const Xe={clickNoSelectText:"index__clickNoSelectText--n_Fng",DraftInput:"index__DraftInput--MGWF3",comments:"index__comments--yBw5J",content:"index__content--zsZsj",avatar:"index__avatar--UCsQC",image:"index__image--EhdqI",input:"index__input--jjQR0",textAreaWrap:"index__textAreaWrap--ZqHek",textArea:"index__textArea--wV57Z",darkTextArea:"index__darkTextArea--Pb6PD",emojiWrap:"index__emojiWrap--kXI4G",iconfontWrap:"index__iconfontWrap--Ogn2k",iconfont:"index__iconfont--km2NG",iconText:"index__iconText--EUFDs",uploadStyle:"index__uploadStyle--RFNRa",ACTION:"index__ACTION--SoFHe",enter:"index__enter--InZSR",darkBtn:"index__darkBtn--bwT9R",hide:"index__hide--F6efx",emojiPopover:"index__emojiPopover--h1si0"};function $e(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function en(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?$e(Object(t),!0).forEach((function(n){(0,x.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$e(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var nn=qe.Z.TextArea;const tn=function(e){var n=e.showAvatar,t=void 0===n||n,r=e.className,i=e.selectComment,a=e.isThreeTier,l=e.onJump,u=e.onReplay,h=e.getCommentList,x=(e.onHideInput,e.focus),f=void 0===x||x,p=e.getAlertStatus,v=e.themeMode,_=e.htmlWidth,j=void 0===_?0:_,g=e.textAreaWrapH5,N=e.emojiWrapH5,I=e.detail,b=(0,o.useState)(!1),k=(0,c.Z)(b,2),w=k[0],y=k[1],Z=(0,o.useState)(!1),O=(0,c.Z)(Z,2),S=O[0],T=O[1],W=(0,o.useState)(""),P=(0,c.Z)(W,2),A=P[0],E=P[1],L=(0,d.UO)().id,M=(0,o.useRef)(),U=(0,q.Z)().userInfoStore.getUserInfo;(0,o.useEffect)((function(){return window.addEventListener("click",D),function(){window.removeEventListener("click",D)}}),[]),(0,o.useEffect)((function(){M&&M.current&&f&&M.current.focus({cursor:"end"})}),[M,f]),(0,o.useEffect)((function(){return window.addEventListener("keydown",R),function(){window.removeEventListener("keydown",R)}}),[A,M]);var R=function(e){e.ctrlKey&&13===e.keyCode&&(F(),M.current.blur())},D=function(e){e.target.id||y(!1)},F=function(){var e=(0,z.Z)(V().mark((function e(){var n,t,r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A.trim()){e.next=2;break}return e.abrupt("return");case 2:if(U){e.next=8;break}return p&&p(!0),u&&u({},!0),E(""),y(!1),e.abrupt("return");case 8:return n={userId:null==U?void 0:U.userId,username:null==U?void 0:U.username,articleId:L||"",date:(new Date).valueOf(),content:A,commentId:null==i?void 0:i.commentId,fromUsername:null==i?void 0:i.username,fromUserId:null==i?void 0:i.userId,formContent:null==i?void 0:i.content,fromCommentId:null==i?void 0:i.commentId},a||(delete n.fromUsername,delete n.fromUserId,delete n.formContent,delete n.fromCommentId),e.t0=G.wg,e.next=13,J.nt(n);case 13:e.t1=e.sent,t=(0,e.t0)(e.t1),u&&u({},!0),E(""),y(!1),t.success&&(h&&h(),a||null!=i&&i.commentId||!I||(null==U?void 0:U.userId)===(null==I?void 0:I.authorId)||(null==U?void 0:U.userId)===(null==I?void 0:I.authorId)||(delete(r=en({},I)).content,(0,ae.bG)(JSON.stringify({action:"push",data:en(en({},r),{},{toUserId:null==r?void 0:r.authorId,articleId:null==r?void 0:r.id,fromUsername:null==U?void 0:U.username,fromUserId:null==U?void 0:U.userId,action:"COMMENT"}),userId:null==U?void 0:U.userId})))),t.success||409!==t.code||p&&p(!0),t.success||409===t.code||401===t.code||(0,G.vU)(t.message);case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=(0,C.jsx)(Qe,{addEmoji:function(e){var n,t=(0,G.Oq)({keyword:A,node:null===(n=(null==M?void 0:M.current).resizableTextArea)||void 0===n?void 0:n.textArea,emoji:e});E(t)},setVisible:T}),Q=function(){var e=(0,z.Z)(V().mark((function e(n){var t,r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y(!0),r=(0,G.Oq)({keyword:A,node:null===(t=(null==M?void 0:M.current).resizableTextArea)||void 0===t?void 0:t.textArea,username:U.username,url:n}),E(r),M.current.focus({cursor:"end"});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,C.jsxs)("div",{className:Xe.DraftInput,id:"DRAFT_INPUT",children:[t&&(0,C.jsx)("div",{id:"COMMENTS",className:Xe.comments,children:"评论"}),(0,C.jsxs)("div",{className:m()(r,Xe.content),id:"CONTENT",children:[t&&(0,C.jsx)("div",{className:Xe.avatar,id:"AVATAR",children:(0,C.jsx)(H.Z,{url:(null==U?void 0:U.headUrl)||Se.Hn,transitionImg:Se.Hn,className:Xe.image,id:"IMAGE",onClick:l})}),(0,C.jsxs)("div",{className:Xe.input,id:"INPUT",children:[(0,C.jsx)("div",{className:m()(Xe.textAreaWrap,g),id:"TEXTAREA_WRAP",children:(0,C.jsx)(nn,{placeholder:null!=i&&i.content?"回复 ".concat(null==i?void 0:i.content,"..."):"请输入评论（Enter换行，Ctrl + Enter 发送）",autoSize:{minRows:3},className:m()(Xe.textArea,"dark"===v&&Xe.darkTextArea),value:A,onFocus:function(){y(!0)},id:"TEXTAREA_WRAP",ref:M,onChange:function(e){E(e.target.value)}})}),(w||!t)&&(0,C.jsxs)("div",{className:m()(Xe.emojiWrap,N,!w&&Xe.hide),id:"EMOJI_WRAP",children:[(0,C.jsxs)("div",{id:"ICONFONT",className:Xe.iconfontWrap,children:[(0,C.jsx)(B.Z,{visible:S,placement:"bottomLeft",content:K,trigger:"click",title:null,overlayClassName:Xe.emojiPopover,overlayInnerStyle:{padding:0},onVisibleChange:function(e){T(e)},children:(0,C.jsx)("span",{className:m()(Xe.iconfont,"iconfont icon-xiaolian"),id:"BIAOQING_XUE",children:(0,C.jsx)("span",{id:"BIAOQING_XUE",className:Xe.iconText,children:"表情"})})}),(0,C.jsx)(Ye.Z,{formLabel:"mainCover",uploadWrapStyle:Xe.uploadWrapStyle,aspectRatio:0,needPreview:!1,uploadStyle:Xe.uploadStyle,listType:"text",getUploadFilePath:Q,uploadNode:(0,C.jsx)("div",{className:m()(Xe.iconfont,"iconfont icon-tupian"),id:"CHARUTUPIAN",children:(0,C.jsx)("span",{id:"CHARUTUPIAN",className:Xe.iconText,children:"图片"})})})]}),(0,C.jsxs)("div",{id:"ACTION",className:"dark"===v?Xe.darkBtn:"",children:[j>960&&(0,C.jsx)("span",{id:"ENTER",className:Xe.enter,children:"Ctrl + Enter"}),(0,C.jsx)(s.Z,{id:"BTN",type:"primary",disabled:!A.trim(),onClick:F,children:(0,C.jsx)("span",{id:"BTN",children:"发表评论"})})]})]},w?1:2)]})]})]})},rn="index__removeCommentConfirm--jMDbo",an="index__darkRemoveCommentConfirm--SRwZg",sn="index__Comments--XqwIL",cn="index__draftInputWrap--CJPM7",on="index__title--i_ovj",ln="index__replyCount--MuXBj",dn="index__commentWrap--bWLWa",un="index__avatar--MdIq9",mn="index__image--Zsw5S",hn="index__iconWrap--vgw8t",xn="index__isLike--rYgPq",fn="index__commentContent--F3tyM",pn="index__commentMain--bmgHy",vn="index__deleteComment--X6Gi_",_n="index__userInfo--riipN",jn="index__name--PKMrN",gn="index__isAuthor--DBg1m",Nn="index__replyInfo--Nq4Z7",In="index__fromUsername--eTMg4",bn="index__date--ux3ub",kn="index__formContent--Yi57n",wn="index__action--kvu0V",yn="index__actionContent--ptP_D",Cn="index__likeAndReplay--H2hcL",Zn="index__draftContent--Xk5j8",On="index__cancelReplay--cFcGJ",Sn="index__commentChild--VAK2s",Tn="index__commentChildItem--KE4BV",Wn="index__commentChildItemContent--X6vZo",Pn="index__viewMore--mVrhK",An="index__viewText--nIfcz",En="index__dark--vwtB2",Ln="index__desc--UiidR",Mn="index__textAreaWrapH5--SFYhW",Un="index__emojiWrapH5--fJokD";const Rn=function(e){var n=e.authorId,t=e.getCommentLength,r=e.themeMode,i=e.htmlWidth,a=void 0===i?0:i,u=e.detail,h=(0,o.useState)([]),x=(0,c.Z)(h,2),f=x[0],p=x[1],v=(0,o.useState)(),_=(0,c.Z)(v,2),j=_[0],g=_[1],N=(0,o.useState)(!1),I=(0,c.Z)(N,2),b=I[0],k=I[1],w=(0,o.useState)([]),y=(0,c.Z)(w,2),Z=y[0],O=y[1],S=(0,d.UO)().id,T=(0,l.lr)(),W=(0,c.Z)(T,1)[0].get("needScroll"),P=(0,$.vO)(W).commentRef,A=(0,$.bc)(),E=A.showAlert,L=A.toLogin,M=A.onCloseAlert,U=A.setAlertStatus,R=(0,q.Z)().userInfoStore.getUserInfo,D=(0,d.s0)();(0,o.useEffect)((function(){Q()}),[S]);var B=function(e){var n=0;return e.forEach((function(e){var t,r=(null===(t=e.replyList)||void 0===t?void 0:t.length)||0;n+=r+1})),n},F=(0,o.useMemo)((function(){return B(Z)}),[Z]),Q=function(){var e=(0,z.Z)(V().mark((function e(){var n,r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=K.w,e.next=3,J.Rw({id:S,userId:null==R?void 0:R.userId});case 3:e.t1=e.sent,(n=(0,e.t0)(e.t1)).success?(O(n.data),r=B(n.data),ee.N.getCommentNum(r),t&&t(n.data)):(0,G.vU)(n.message);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(e){p([].concat((0,Fe.Z)(f),[e]))},X=function(e,n){return f.includes(n)?e:e.slice(0,2)},ne=function(e,n){g(n?{}:e)},re=function(){g({})},ie=function(){var e=(0,z.Z)(V().mark((function e(n,t){var r,i;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=2;break}return e.abrupt("return");case 2:if(R){e.next=5;break}return U&&U(!0),e.abrupt("return");case 5:return r=t?{commentId:n.commentId,fromCommentId:n.commentId,userId:null==R?void 0:R.userId}:{commentId:n.commentId,userId:null==R?void 0:R.userId},k(!0),e.t0=K.w,e.next=10,J.FD(r);case 10:e.t1=e.sent,i=(0,e.t0)(e.t1),k(!1),i.success&&Q&&Q(),i.success||409!==i.code||U&&U(!0),i.success||409===i.code||401===i.code||(0,G.vU)(i.message);case 16:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),ae=function(e,n){var t=n?{commentId:e.commentId,fromCommentId:e.commentId,articleId:S}:{commentId:e.commentId,articleId:S};ze.Z.confirm(se(t))},se=function(e){return{title:"确定删除该评论吗？",className:a<960?m()(rn,"dark"===r&&an):"",centered:a<960,width:a<960?"80%":"",onOk:function(){return(0,z.Z)(V().mark((function n(){return V().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:ce(e);case 1:case"end":return n.stop()}}),n)})))()}}},ce=function(){var e=(0,z.Z)(V().mark((function e(n){var t;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=K.w,e.next=3,J.YF(n);case 3:e.t1=e.sent,(t=(0,e.t0)(e.t1)).success&&Q&&Q(),t.success||409!==t.code||U&&U(!0),t.success||409===t.code||401===t.code||(0,G.vU)(t.message);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),oe=function(e){D("/personal?id=".concat(e))};return(0,C.jsxs)("div",{className:m()(sn,"dark"===r&&En),ref:P,children:[E&&(0,C.jsx)(Ve.Z,{onClick:L,onClose:M}),(0,C.jsx)("div",{className:cn,children:(0,C.jsx)(tn,{getCommentList:Q,focus:!1,getAlertStatus:U,onJump:function(){return oe(n)},themeMode:r,htmlWidth:a,detail:u})}),(null==Z?void 0:Z.length)>0&&(0,C.jsxs)("div",{className:on,children:["全部评论",(0,C.jsx)("span",{className:ln,children:F})]}),(null==Z?void 0:Z.length)>0&&Z.map((function(e){var t;return(0,C.jsxs)("div",{className:dn,children:[(0,C.jsx)("div",{className:un,children:(0,C.jsx)(H.Z,{url:e.headUrl||Se.Hn,transitionImg:Se.Hn,className:mn,onClick:function(){return oe(e.userId)}})}),(0,C.jsxs)("div",{className:fn,children:[(0,C.jsxs)("div",{className:pn,children:[(0,C.jsxs)("div",{className:_n,children:[(0,C.jsx)("span",{className:jn,children:e.username}),(0,C.jsx)("span",{className:bn,children:(0,G.fg)(e.date)})]}),(0,C.jsx)("div",{className:Ln,dangerouslySetInnerHTML:{__html:(0,G.Mm)(e.content||"")}}),(0,C.jsxs)("div",{className:wn,children:[(0,C.jsxs)("div",{className:yn,children:[(0,C.jsxs)("div",{className:Cn,children:[(0,C.jsx)(te.Z,{name:"".concat(e.isLike?"icon-24gf-thumbsUp2":"icon-24gl-thumbsUp2"),text:e.likeCount>0?e.likeCount:"点赞",iconWrapClass:hn,className:e.isLike?xn:null,onClick:function(){return ie(e)}}),(0,C.jsx)(te.Z,{name:"icon-comment",className:(null==j?void 0:j.commentId)===e.commentId?On:null,text:(null==j?void 0:j.commentId)===e.commentId?(0,C.jsx)("span",{className:On,id:"ON_REPLAY",children:"取消回复"}):(0,C.jsx)("span",{children:(null===(t=e.replyList)||void 0===t?void 0:t.length)||"回复"}),iconWrapClass:hn,onClick:function(){return ne(e,(null==j?void 0:j.commentId)===e.commentId)}})]}),(null==R?void 0:R.userId)===e.userId&&(0,C.jsx)(s.Z,{type:"link",className:vn,onClick:function(){return ae(e)},children:"删除"})]}),(null==j?void 0:j.commentId)===e.commentId&&(0,C.jsx)(tn,{showAvatar:!1,className:Zn,selectComment:j,onReplay:ne,getCommentList:Q,onHideInput:re,getAlertStatus:U,themeMode:r,htmlWidth:a})]})]}),e.replyList&&e.replyList.length>0&&(0,C.jsxs)("div",{className:Sn,children:[X(e.replyList,e.commentId).map((function(e){return(0,C.jsxs)("div",{className:Tn,children:[(0,C.jsx)("div",{className:un,children:(0,C.jsx)(H.Z,{url:e.headUrl||Se.Hn,transitionImg:Se.Hn,className:mn,onClick:function(){return oe(e.userId)}})}),(0,C.jsxs)("div",{className:Wn,children:[(0,C.jsxs)("div",{className:_n,children:[(0,C.jsxs)("span",{className:jn,children:[(0,C.jsx)("span",{children:e.username}),e.userId===n&&(0,C.jsx)("span",{className:gn,children:"(作者)"}),e.fromUsername&&(0,C.jsxs)("span",{className:Nn,children:["回复",(0,C.jsx)("span",{className:In,children:e.fromUsername})]})]}),(0,C.jsx)("span",{className:bn,children:(0,G.fg)(e.date)})]}),e.content&&(0,C.jsx)("div",{className:Ln,dangerouslySetInnerHTML:{__html:(0,G.Mm)(e.content||"")}}),e.formContent&&(0,C.jsx)("div",{className:kn,children:"“".concat(e.formContent,"”")}),(0,C.jsxs)("div",{className:wn,id:"ON_REPLAY",children:[(0,C.jsxs)("div",{className:yn,children:[(0,C.jsxs)("div",{className:Cn,children:[(0,C.jsx)(te.Z,{name:"".concat(e.isLike?"icon-24gf-thumbsUp2":"icon-24gl-thumbsUp2"),text:e.likeCount>0?e.likeCount:"点赞",iconWrapClass:hn,className:e.isLike?xn:null,onClick:function(){return ie(e,!0)}}),(0,C.jsx)(te.Z,{name:"icon-comment",className:(null==j?void 0:j.commentId)===e.commentId?On:null,text:(null==j?void 0:j.commentId)===e.commentId?(0,C.jsx)("span",{className:On,id:"ON_REPLAY",children:"取消回复"}):(0,C.jsx)("span",{children:"回复"}),iconWrapClass:hn,onClick:function(){return ne(e,(null==j?void 0:j.commentId)===e.commentId)}})]}),(null==R?void 0:R.userId)===e.userId&&(0,C.jsx)(s.Z,{type:"link",className:vn,onClick:function(){return ae(e,!0)},children:"删除"})]}),(null==j?void 0:j.commentId)===e.commentId&&(0,C.jsx)(tn,{showAvatar:!1,className:Zn,selectComment:j,isThreeTier:!0,onReplay:ne,getCommentList:Q,onHideInput:re,getAlertStatus:U,themeMode:r,htmlWidth:a,textAreaWrapH5:Mn,emojiWrapH5:Un})]})]})]},e.commentId)})),X(e.replyList,e.commentId).length!==e.replyList.length&&(0,C.jsxs)("div",{className:Pn,onClick:function(){return Y(e.commentId)},children:[(0,C.jsxs)("span",{className:An,children:["查看更多（",e.replyList&&e.replyList.length-2,"条）回复"]}),(0,C.jsx)(te.Z,{name:"icon-xiajiantou",iconWrapClass:hn,onClick:function(){return Y(e.commentId)}})]})]})]})]},e.commentId)}))]})},Dn="index__AnotherArticle--bPPC4",Hn="index__prevArticle--QJc3Z",Bn="index__title--vsu5M",zn="index__abstract--YoZZ1",Fn="index__info--yuoMi",Vn="index__item--ntzbK",qn="index__icon--aCnVN",Jn="index__nextArticle--JMj6Y",Kn="index__dark--z14LK";function Gn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Qn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Gn(Object(t),!0).forEach((function(n){(0,x.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Gn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const Yn=function(e){var n,t,r=e.id,i=e.themeMode,a=(0,o.useState)([]),s=(0,c.Z)(a,2),l=s[0],u=s[1],h=(0,d.s0)(),x=G.tO.locGetItem("params")&&JSON.parse(G.tO.locGetItem("params"))||{};(0,o.useEffect)((function(){f()}),[r]);var f=function(){var e=(0,z.Z)(V().mark((function e(){var n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([p(),v()]);case 2:null!=(n=e.sent)&&n.length&&u(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=(0,z.Z)(V().mark((function e(){var n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=K.w,e.next=3,J.A(Qn({id:r},x));case 3:return e.t1=e.sent,n=(0,e.t0)(e.t1),e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=(0,z.Z)(V().mark((function e(){var n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=K.w,e.next=3,J.XC(Qn({id:r},x));case 3:return e.t1=e.sent,n=(0,e.t0)(e.t1),e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(e){h("/detail/".concat(e))};return null!==(n=l[0])&&void 0!==n&&n.id||null!==(t=l[1])&&void 0!==t&&t.id?(0,C.jsx)("div",{className:m()(Dn,"dark"===i&&Kn),children:l.map((function(e,n){var t,r;return(0,C.jsxs)("div",{className:n>0?Jn:Hn,onClick:function(){return _&&_(e.id)},children:[0===n&&(null==e?void 0:e.id)&&(0,C.jsx)("div",{className:qn,children:(0,C.jsx)(te.Z,{name:"icon-arrow-left-bold",noStopPropagation:!0})}),e.id&&(0,C.jsxs)("div",{className:Vn,children:[(0,C.jsx)("div",{className:Bn,children:null==e?void 0:e.title}),(0,C.jsx)("div",{className:zn,children:null==e?void 0:e.abstract}),(0,C.jsxs)("div",{className:Fn,children:[(0,C.jsx)("span",{title:null==e?void 0:e.authorName,children:(null==e||null===(t=e.authorName)||void 0===t?void 0:t.length)>20?"".concat(null==e||null===(r=e.authorName)||void 0===r?void 0:r.slice(0,19),"..."):null==e?void 0:e.authorName}),(0,C.jsx)("span",{children:" · ".concat(null==e?void 0:e.tag," · ")}),(0,C.jsx)("span",{children:"".concat(null==e?void 0:e.classify," · ")}),(0,C.jsx)("span",{children:(0,G.fg)(null==e?void 0:e.createTime)})]})]}),n>0&&(null==e?void 0:e.id)&&(0,C.jsx)("div",{className:qn,children:(0,C.jsx)(te.Z,{name:"icon-arrow-right-bold",noStopPropagation:!0})})]},e.id||n)}))}):null};var Xn=t(26260),$n=t(39841);const et="index__TocDrawer--vSanz",nt="index__mack--y5SCb",tt="index__mackNav--LBmry",rt="index__tocTitle--bEbU4",it="index__scrollbar--e96Wd",at="index__tocList--D4lrK",st="index__showTocDrawer--CUdek",ct="index__dark--eDVla";function ot(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function lt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ot(Object(t),!0).forEach((function(n){(0,x.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ot(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const dt=function(e){var n,t=e.visible,r=e.onCancel,i=e.detail,a=e.themeMode,s=(0,$.nf)({tocVisible:t}).tocScrollRef;(0,o.useEffect)((function(){document.body.style.overflow=t?"hidden":"auto"}),[t]);return(0,C.jsxs)("div",{className:m()(et,t&&st,"dark"===a&&ct),children:[(0,C.jsx)("div",{className:nt,onClick:function(){r&&r()}}),null!=i&&null!==(n=i.content)&&void 0!==n&&n.includes("#")?(0,C.jsxs)("div",{className:tt,children:[(0,C.jsx)("div",{className:rt,children:"文章目录"}),(0,C.jsx)(Pe.$B,{autoHide:!0,ref:s,renderThumbVertical:function(){return(0,C.jsx)("div",{style:lt({},{backgroundColor:"rgba(225, 225, 225, 0)"})})},autoHeight:!0,autoHeightMax:350,className:it,children:(0,C.jsx)(We.ZP,{className:at,source:null==i?void 0:i.content,headingTopOffset:60,declarative:!1,ordered:!0})})]}):null]})},ut="index__ActionBar--p3VQL",mt="index__changeIconWrap--wHpnR",ht="index__container--A0qMT",xt="index__actionBtn--aoZ8D",ft="index__tocIcon--agp4U",pt="index__commentIcon--o5GMV",vt="index__actionIcon--xCTRy",_t="index__collectionIcon--kIKXq",jt="index__likeActionIcon--q8T6o",gt="index__collectedIcon--Hi8Ux",Nt="index__likeCount--CjEyn",It="index__showBar--vdmhf",bt="index__darkIconWrap--g6K7t";function kt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function wt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?kt(Object(t),!0).forEach((function(n){(0,x.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):kt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const yt=function(e){var n=e.id,t=e.detail,r=e.commentRef,i=e.className,a=e.themeMode,s=e.htmlWidth,l=void 0===s?0:s,u=(0,o.useState)(!1),h=(0,c.Z)(u,2),x=h[0],f=h[1],p=(0,o.useState)(0),v=(0,c.Z)(p,2),_=v[0],j=v[1],g=(0,o.useState)(!1),N=(0,c.Z)(g,2),I=N[0],b=N[1],k=(0,o.useState)(!1),w=(0,c.Z)(k,2),y=w[0],Z=w[1],O=(0,o.useState)(!1),S=(0,c.Z)(O,2),T=S[0],W=S[1],P=(0,o.useState)(!1),A=(0,c.Z)(P,2),E=A[0],L=A[1],M=(0,o.useState)(!1),U=(0,c.Z)(M,2),R=U[0],D=U[1],H=(0,o.useState)(0),B=(0,c.Z)(H,2),F=B[0],Q=B[1],Y=(0,o.useState)(!1),X=(0,c.Z)(Y,2),re=X[0],se=X[1],ce=(0,q.Z)().userInfoStore.getUserInfo,oe=(0,d.TH)(),le=oe.pathname,de=oe.search,ue=(0,$.vV)(!0,!1,!0).loginStatus,me=(0,o.useRef)(null),he=(0,o.useRef)(null);(0,o.useEffect)((function(){if(ne.$&&!re)return he.current&&(clearTimeout(he.current),he.current=null),he.current=setTimeout((function(){f(!1)}),5e3),function(){clearTimeout(he.current),he.current=null}}),[x,re]),(0,o.useEffect)((function(){ee.N.onSetCommentCount.listen((function(){var e=ee.N.commentCount;Q(e)}))}),[]),(0,o.useEffect)((function(){j(null==t?void 0:t.likeCount),b(null==t?void 0:t.isLike)}),[t]),(0,o.useEffect)((function(){y||pe()}),[y,n,ue]);var xe=function(){me.current&&(clearInterval(me.current),me.current=null),me.current=setTimeout((function(){(0,ne.x)()}),5e3)},fe=function(){var e=(0,z.Z)(V().mark((function e(){var r,i;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:if(null!=ce&&ce.userId&&ue.success){e.next=6;break}return(0,ne.$)({pathname:le,search:de}),xe(),e.abrupt("return");case 6:return e.t0=K.w,e.next=9,J.HA({id:n,userId:null==ce?void 0:ce.userId});case 9:if(e.t1=e.sent,(r=(0,e.t0)(e.t1)).success){e.next=14;break}return 401!==r.code&&((0,ne.$)({pathname:le,search:de}),xe()),e.abrupt("return");case 14:b(r.data.isLike),j(I?_-1:_+1),(null==ce?void 0:ce.userId)!==(null==t?void 0:t.authorId)&&(delete(i=wt({},t)).content,(0,ae.bG)(JSON.stringify({action:"push",data:wt(wt({},i),{},{articleId:n,toUserId:null==i?void 0:i.authorId,fromUsername:null==ce?void 0:ce.username,fromUserId:null==ce?void 0:ce.userId,action:I?"LIKE_ARTICLE":"CANCEL_LIKE_ARTICLE"}),userId:null==ce?void 0:ce.userId})));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=function(){var e=(0,z.Z)(V().mark((function e(){var t;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=ce&&ce.userId&&ue.success){e.next=2;break}return e.abrupt("return");case 2:return e.t0=K.w,e.next=5,J.DA({articleId:n,userId:null==ce?void 0:ce.userId});case 5:e.t1=e.sent,(t=(0,e.t0)(e.t1)).success&&L(t.data.collected);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve=function(){if(null==ce||!ce.userId||!ue.success)return(0,ne.$)({pathname:le,search:de}),void xe();Z(!0)},_e=function(){var e=(0,z.Z)(V().mark((function e(){var t;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=K.w,e.next=3,J.WH({articleId:n,userId:null==ce?void 0:ce.userId});case 3:e.t1=e.sent,(t=(0,e.t0)(e.t1)).success?pe():409===t.code?((0,ne.$)({pathname:le,search:de}),xe()):(0,G.vU)(t.message);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,C.jsxs)("div",{className:m()(ut,i),onMouseEnter:function(){se(!0)},onMouseLeave:function(){se(!1)},children:[(0,C.jsx)(Xn.Z,{className:m()(mt,"dark"===a&&bt),onClick:function(){f(!x)},type:"actionbar",icon:x?"icon-arrow-left-bold":"icon-arrow-right-bold",themeMode:a,htmlWidth:l}),(0,C.jsxs)("div",{className:m()(ht,x&&It,i),children:[(null==t?void 0:t.content.includes("#"))&&(0,C.jsx)("div",{className:xt,children:(0,C.jsx)(te.Z,{name:"icon-mulu",className:ft,onClick:function(){D(!0)},customStyle:!0})}),(0,C.jsxs)("div",{className:xt,children:[(0,C.jsx)(te.Z,{name:"icon-pinglun1",className:pt,onClick:function(){if(r.current){var e=r.current.offsetTop;document.documentElement.scrollTop=e}},customStyle:!0}),F>0&&(0,C.jsx)("span",{className:Nt,children:F>999?(0,C.jsx)("span",{title:F&&JSON.stringify(F)||"",children:"999+"}):F})]}),(0,C.jsxs)("div",{className:xt,children:[(0,C.jsx)(te.Z,{name:"icon-24gf-thumbsUp2",className:m()(vt,I&&jt),onClick:fe,customStyle:!0}),_>0&&(0,C.jsx)("span",{className:Nt,children:_})]}),(0,C.jsx)("div",{className:xt,children:(0,C.jsx)(te.Z,{name:"icon-31shoucangxuanzhong",className:m()(_t,E&&gt),onClick:E?_e:ve,customStyle:!0})})]}),(0,C.jsx)($n.Z,{visible:y,onCancel:function(){return Z(!1)},showCollectionDrawer:ve,themeMode:a}),(0,C.jsx)(ie.Z,{visible:T,onCancel:function(){return W(!1)},showCollection:ve,themeMode:a},Math.random()),(0,C.jsx)(dt,{detail:t,visible:R,onCancel:function(){return D(!1)},themeMode:a},null==t?void 0:t.content)]})},Ct={clickNoSelectText:"index__clickNoSelectText--WJZrg",hanToc:"index__hanToc--G1rdu",spinWrap:"index__spinWrap--Mci38",iconWrap:"index__iconWrap--sDl57",detailContainer:"index__detailContainer--NNMtZ",toLogin:"index__toLogin--FP9ZK",alert:"index__alert--hWZOl",headerWrap:"index__headerWrap--UgvEc",content:"index__content--lLQ4o",preview:"index__preview--lA2UL",previewSpin:"index__previewSpin--kdiDY",loadText:"index__loadText--GiY86",previewContent:"index__previewContent--s1Ez_",tagWrap:"index__tagWrap--pbval",tagList:"index__tagList--_ph4E",label:"index__label--ejVyv",tag:"index__tag--zESUa",spin:"index__spin--MeCCP",titleWrap:"index__titleWrap--XLWSq",title:"index__title--pFFF1",userInfo:"index__userInfo--b_Tu_",herdImg:"index__herdImg--bTkQ7",createInfo:"index__createInfo--hXnwU",username:"index__username--gyb8l",readCount:"index__readCount--lfzkM",image:"index__image--K148F",desc:"index__desc--mIMLa",rightBar:"index__rightBar--NpPSA",headerContent:"index__headerContent--xIVZv",menuList:"index__menuList--YAe83",backTopWrap:"index__backTopWrap--uUGJd",backTop:"index__backTop--S5BSL",topIcon:"index__topIcon--e89Nl",mobileBackTopWrap:"index__mobileBackTopWrap--obQhE",dark:"index__dark--rrRSf",darkIcon:"index__darkIcon--cHcdX",herderWrap:"index__herderWrap--cnzuc",darkActionBar:"index__darkActionBar--bmUnR"};const Zt=function(){var e=(0,d.s0)(),n=(0,d.UO)().id,t=(0,l.lr)(),u=(0,c.Z)(t,1)[0].get("draft"),x=(0,$.zu)(u?{draftId:n}:{id:n}),f=x.detail,p=x.loading,v=(0,q.Z)().userInfoStore.getUserInfo,_=(0,$.nR)().htmlWidth,j=(0,$.iy)().themeMode,g=(0,o.useRef)(null);(0,o.useEffect)((function(){(0,ae.mN)(),null!=v&&v.userId}),[null==v?void 0:v.userId]),(0,o.useEffect)((function(){null!=f&&f.isDelete&&((0,G.um)("该文章已下架"),e("/home"))}),[f]);var N=function(){e("/search")},I=function(){e("/create?id=".concat(n))};return(0,C.jsxs)(r.Z,{spinning:p,className:Ct.spinWrap,tip:"正在卖力加载中...",children:[(0,C.jsxs)("div",{className:m()(Ct.detailContainer,(null==f?void 0:f.content.includes("#"))&&Ct.hanToc,"dark"===j&&Ct.dark),children:[(0,C.jsx)("div",{className:Ct.headerWrap,children:(0,C.jsx)(D.Z,{needLeft:!0,excludesWidth:!0,right:(0,C.jsx)("div",{className:Ct.searchWrap,children:(0,C.jsx)(te.Z,{name:"icon-sousuo2",className:m()(Ct.iconWrap,"dark"===j&&Ct.darkIcon),onClick:N})}),needUser:!0,themeMode:j,children:(0,C.jsx)("div",{className:Ct.headerContent,children:"文章详情"})})}),f&&(0,C.jsxs)("div",{className:Ct.content,children:[(0,C.jsxs)("div",{className:Ct.preview,children:[_>960&&(0,C.jsx)(Ze,{id:n,detail:f,commentRef:g,themeMode:j}),(0,C.jsx)(R,{className:Ct.previewContent,mackdown:f.content,coverImg:function(n){return(0,C.jsxs)("div",{className:Ct.titleWrap,children:[(0,C.jsx)("div",{className:Ct.title,children:null==n?void 0:n.title}),(0,C.jsxs)("div",{className:Ct.userInfo,children:[(0,C.jsx)(H.Z,{url:(null==n?void 0:n.headUrl)||Se.Hn,transitionImg:Se.Hn,className:Ct.herdImg,onClick:function(){return t=null==n?void 0:n.authorId,void e("/personal?id=".concat(t));var t}}),(0,C.jsxs)("div",{className:Ct.createInfo,children:[(0,C.jsx)("div",{className:Ct.username,children:null==n?void 0:n.authorName}),(0,C.jsxs)("div",{children:[(0,C.jsx)("span",{children:(0,G.p6)(null==n?void 0:n.createTime,"YYYY年MM月DD日 HH:mm")}),(0,C.jsxs)("span",{className:Ct.readCount,children:["阅读 ",null==n?void 0:n.readCount]}),(null==v?void 0:v.userId)===(null==n?void 0:n.authorId)&&(0,C.jsx)(s.Z,{type:"link",onClick:I,children:"编辑"})]})]})]}),(null==n?void 0:n.coverImage)&&(0,C.jsx)(H.Z,{url:(null==n?void 0:n.coverImage)||Se.zl,transitionImg:Se.zl,className:Ct.image}),(0,C.jsx)("p",{className:Ct.desc,children:n.abstract})]})}(f),children:(0,C.jsxs)("div",{className:Ct.tagWrap,children:[f.classify&&(0,C.jsxs)("div",{className:Ct.tagList,children:[(0,C.jsx)("span",{className:Ct.label,children:"分类："}),(0,C.jsx)("div",{className:Ct.tagItemWrap,children:(0,C.jsx)("span",{className:Ct.tag,onClick:function(n){return function(n,t){n.stopPropagation(),e("/classify?classify=".concat(t))}(n,f.classify)},children:f.classify})})]}),f.tag&&(0,C.jsxs)("div",{className:Ct.tagList,children:[(0,C.jsx)("span",{className:Ct.label,children:"标签："}),(0,C.jsx)("div",{className:Ct.tagItemWrap,children:(0,C.jsx)("span",{className:Ct.tag,onClick:function(n){return t=f.tag,void e("/tag/list?tagName=".concat(t));var t},children:f.tag})})]})]})}),!u&&(0,C.jsx)("div",{className:Ct.anotherArticle,children:(0,C.jsx)(Yn,{id:n,themeMode:j})}),!u&&(0,C.jsx)("div",{ref:g,className:Ct.commentContainer,children:(0,C.jsx)(Rn,{authorId:f.authorId,themeMode:j,htmlWidth:_,detail:f})})]}),_>960&&(0,C.jsxs)("div",{className:Ct.rightBar,children:[(0,C.jsx)(Te.Z,{themeMode:j,htmlWidth:_}),(0,C.jsx)(a.Z,{offsetTop:50,children:(0,C.jsx)(Be,{mackdown:f.content,themeMode:j})})]})]}),_<=960&&f&&!u&&(0,C.jsx)(yt,{id:n,detail:f,commentRef:g,className:"dark"===j?Ct.darkActionBar:"",themeMode:j,htmlWidth:_}),_<=960&&(0,C.jsx)(Oe.Z,{themeMode:j}),(0,C.jsx)(Xn.Z,{noHideMenuIcon:!0,fromDetail:!0,themeMode:j,htmlWidth:_})]}),(0,C.jsx)(i.Z,{className:_>960?Ct.backTopWrap:Ct.mobileBackTopWrap,children:(0,C.jsx)("div",{className:Ct.backTop,children:(0,C.jsx)(h.Z,{className:Ct.topIcon})})})]})}}}]);