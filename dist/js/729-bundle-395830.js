"use strict";(self.webpackChunkwebpack_config=self.webpackChunkwebpack_config||[]).push([[729],{84729:(e,n,t)=>{t.r(n),t.d(n,{default:()=>C});t(34935);var r=t(71577),s=(t(900),t(9676)),a=(t(69229),t(21888)),c=(t(37796),t(24044)),i=t(4942),o=t(15861),l=(t(44295),t(67773)),u=t(29439),d=t(64687),m=t.n(d),f=t(67294),p=t(39711),h=t(96974),x=t(80411),g=t.n(x),v=t(19674),b=t(95717),j=t(20555),_=t(90078);const w={clickNoSelectText:"index__clickNoSelectText--YltgU",container:"index__container--b7RZj",wrap:"index__wrap--qcew6",content:"index__content--bB4DJ",title:"index__title--ME51e",form:"index__form--wjK6Z",userInfo:"index__userInfo--JXDxD",actions:"index__actions--zR3nj",login:"index__login--_etJJ",codeItem:"index__codeItem--c6ReI",phoneInp:"index__phoneInp--mgpAY",forget:"index__forget--f6L87",backBtn:"index__backBtn--oT50y",forgetBtn:"index__forgetBtn--CSrMK",resetModel:"index__resetModel--No6hh",resetInfo:"index__resetInfo--e7efH",verifyInfo:"index__verifyInfo--E0E4L",label:"index__label--zK4hk",errMsg:"index__errMsg--AZqKN",showErrMsg:"index__showErrMsg--Yz2If",resetBtnWrap:"index__resetBtnWrap--zEFyM",resetSubmitBtn:"index__resetSubmitBtn--iRgu9",backLogin:"index__backLogin--mTFwU",remember:"index__remember--N4uia"};var k=t(85893);function Z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Z(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var I=j.fP.getCoolie,y=j.fP.setCookie,S=j.fP.removeCoolie;const C=function(){var e=(0,f.useState)(!1),n=(0,u.Z)(e,2),t=n[0],i=n[1],d=(0,f.useState)(I("uname")),x=(0,u.Z)(d,2),Z=x[0],C=x[1],z=(0,f.useState)(""),O=(0,u.Z)(z,2),U=O[0],P=O[1],E=(0,f.useState)(),B=(0,u.Z)(E,2),M=B[0],T=B[1],L=(0,f.useState)(""),D=(0,u.Z)(L,2),H=D[0],q=D[1],V=(0,f.useState)(!1),F=(0,u.Z)(V,2),R=F[0],J=F[1],K=(0,f.useState)({}),W=(0,u.Z)(K,2),Y=W[0],A=W[1],G=(0,f.useState)(!1),Q=(0,u.Z)(G,2),X=Q[0],$=Q[1],ee=(0,v.Z)(),ne=ee.userInfoStore,te=ee.commonStore,re=(0,h.s0)(),se=l.Z.useForm(),ae=(0,u.Z)(se,1)[0],ce=(0,p.lr)(),ie=(0,u.Z)(ce,1)[0],oe=ie.get("verify"),le=ie.get("search"),ue=ie.get("pathname"),de=(0,f.useRef)(null);(0,f.useEffect)((function(){var e;return e=setTimeout((function(){return(0,_.x)()}),3e3),function(){clearInterval(e)}}),[]),(0,f.useEffect)((function(){oe||pe()}),[oe]),(0,f.useEffect)((function(){J(!(!U||!H||U===H))}),[U,H]),(0,f.useEffect)((function(){me()}),[]),(0,f.useEffect)((function(){de.current&&fe(de.current)}),[Y]);var me=function(){var e=(0,o.Z)(m().mark((function e(){var n,t;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=j.wg,e.next=3,(0,b.VP)({id:Y.id});case 3:e.t1=e.sent,(n=(0,e.t0)(e.t1)).success&&(t=(0,j.pe)(n.data.code),A(N(N({},n.data),{},{code:t})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(e){(0,j.Ui)({canvasElement:e,width:120,height:40,code:Y.code})},pe=function(){var e=(0,o.Z)(m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=j.wg,e.next=3,(0,b.T)();case 3:e.t1=e.sent,(0,e.t0)(e.t1).success&&re("".concat(te.auth.redirectUrl)||"".concat(ue).concat(le)||"/home",{replace:!0});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=(0,o.Z)(m().mark((function e(){var n,t,r,s,a;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae.validateFields();case 2:return n=e.sent,t=(0,j.HI)(n.password),r=(0,j.HI)(n.phone),s=n.username,e.t0=j.wg,e.next=9,(0,b.z2)({username:s,password:t,phone:r});case 9:e.t1=e.sent,(a=(0,e.t0)(e.t1)).success?((0,j.Vp)(a.message),ge()):a.message&&(0,j.vU)(a.message);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=(0,o.Z)(m().mark((function e(n){var t,r,s,a,c,i,o;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n,e.t0){e.next=5;break}return e.next=4,ae.validateFields();case 4:e.t0=e.sent;case 5:return t=e.t0,r=(null==t?void 0:t.password)&&(0,j.HI)(t.password),s=null==t?void 0:t.username,a=(null==t?void 0:t.code)&&(0,j.HI)(t.code),e.t1=j.wg,e.next=12,(0,b.x4)({username:s,password:r,codeId:Y.id,code:a});case 12:e.t2=e.sent,(c=(0,e.t1)(e.t2)).success?(delete(o=N({},c.data)).token,ne.setUserInfo(N({},o)),sessionStorage.setItem("token",null===(i=c.data)||void 0===i?void 0:i.token),null!=t&&t.remember?y("100",r,1):S("100"),null!=t&&t.remember?s&&y("uname",s,1):S("uname"),re("".concat(te.auth.redirectUrl)||"".concat(ue).concat(le)||"/home",{replace:!0})):(c.message&&(0,j.vU)(c.message),me());case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ge=function(){me(),$(!X)},ve=function(){me(),i(!1)},be=function(){var e=(0,o.Z)(m().mark((function e(){var n;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Z){e.next=3;break}return(0,j.vU)("账号不能为空"),e.abrupt("return");case 3:if(M){e.next=6;break}return(0,j.vU)("手机号不能为空"),e.abrupt("return");case 6:if(/^1[3456789]\d{9}$/.test(M.toString())){e.next=10;break}return(0,j.vU)("手机号不合法"),e.abrupt("return");case 10:if(U){e.next=13;break}return(0,j.vU)("新密码不能为空"),e.abrupt("return");case 13:if(H){e.next=16;break}return(0,j.vU)("确认密码不能为空"),e.abrupt("return");case 16:if(U===H){e.next=19;break}return(0,j.vU)("两次密码不一致"),e.abrupt("return");case 19:return e.t0=j.wg,e.next=22,(0,b.c0)({username:Z,password:(0,j.HI)(U),phone:(0,j.HI)(M.toString())});case 22:e.t1=e.sent,(n=(0,e.t0)(e.t1)).success?(ne.setUserInfo(N({},n.data)),(0,j.Vp)(n.message),ve()):(0,j.vU)(n.message);case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,k.jsx)("div",{className:w.container,children:(0,k.jsx)("div",{className:w.wrap,children:t?(0,k.jsx)("div",{className:w.content,children:(0,k.jsxs)("div",{className:w.resetModel,children:[(0,k.jsx)("div",{className:w.title,children:"重置用户密码"}),(0,k.jsxs)("div",{className:w.resetInfo,children:[(0,k.jsx)("span",{className:w.label,children:"用户名："}),(0,k.jsx)(c.Z,{placeholder:"请输入用户名",size:"large",value:Z,onChange:function(e){C(e.target.value.trim())},maxLength:20})]}),(0,k.jsxs)("div",{className:w.resetInfo,children:[(0,k.jsx)("span",{className:w.label,children:"手机号码："}),(0,k.jsx)(a.Z,{className:w.phoneInp,value:M,onChange:function(e){T(e)},controls:!1,placeholder:"请输入手机号码（号码将会被加密，无需担心泄露）",size:"large"})]}),(0,k.jsxs)("div",{className:w.resetInfo,children:[(0,k.jsx)("span",{className:w.label,children:"新密码："}),(0,k.jsx)(c.Z.Password,{placeholder:"请输入新密码",size:"large",maxLength:20,value:U,onChange:function(e){P(e.target.value.trim())}})]}),(0,k.jsxs)("div",{className:w.verifyInfo,children:[(0,k.jsx)("span",{className:w.label,children:"确认密码："}),(0,k.jsx)(c.Z.Password,{placeholder:"请输入确认密码",size:"large",maxLength:20,value:H,onChange:function(e){q(e.target.value.trim())}}),(0,k.jsx)("span",{className:g()(w.errMsg,R&&w.showErrMsg),children:"两次密码不一致"})]}),(0,k.jsxs)("div",{className:w.resetBtnWrap,children:[(0,k.jsx)(r.Z,{type:"primary",size:"large",className:w.resetSubmitBtn,onClick:be,children:"重置"}),(0,k.jsx)(r.Z,{htmlType:"submit",size:"large",className:w.backLogin,onClick:ve,children:"返回登录"})]})]})}):(0,k.jsxs)("div",{className:w.content,children:[(0,k.jsx)("div",{className:w.title,children:"账号密码登录"}),(0,k.jsxs)(l.Z,{name:"basic",initialValues:{remember:!0},className:w.form,form:ae,autoComplete:"off",children:[(0,k.jsx)(l.Z.Item,{name:"username",rules:[{required:!0,message:""},{validator:function(e,n){return(0,j.UQ)(e,n)}}],initialValue:I("uname"),children:(0,k.jsx)(c.Z,{placeholder:"请输入用户名",size:"large"})}),(0,k.jsx)(l.Z.Item,{name:"password",rules:[{required:!0,message:""},{validator:function(e,n){return(0,j.Gv)(e,n)}}],initialValue:I("100")?(0,j.pe)(I("100")):void 0,children:(0,k.jsx)(c.Z.Password,{placeholder:"请输入密码",size:"large"})}),!X&&(0,k.jsxs)("div",{className:w.codeItem,children:[(0,k.jsx)(l.Z.Item,{name:"code",rules:[{required:!0,message:"请输入验证码"}],children:(0,k.jsx)(c.Z,{placeholder:"请输入验证码",size:"large"})}),(0,k.jsx)("canvas",{ref:de,className:w.codeCanvas,width:120,height:40,onClick:me})]}),X&&(0,k.jsx)(l.Z.Item,{name:"phone",rules:[{required:!0,message:""},{validator:function(e,n){return(0,j.Zj)(e,n)}}],children:(0,k.jsx)(a.Z,{className:w.phoneInp,controls:!1,placeholder:"请输入手机号码（号码将会被加密，无需担心泄露）",size:"large"})}),(0,k.jsx)(l.Z.Item,{name:"remember",valuePropName:"checked",className:w.remember,children:(0,k.jsx)(s.Z,{children:"记住本次登录密码"})}),(0,k.jsxs)(l.Z.Item,{className:w.actions,children:[!X&&(0,k.jsx)(r.Z,{type:"primary",htmlType:"submit",className:w.login,onClick:function(){return xe()},size:"large",children:"登录"}),X&&(0,k.jsx)(r.Z,{type:"primary",htmlType:"submit",size:"large",className:w.login,onClick:he,children:"注册"})]})]}),(0,k.jsxs)("div",{className:w.forget,children:[(0,k.jsx)(r.Z,{type:"link",className:w.backBtn,onClick:ge,children:X?"已有账号，前往登录":"没有账号，前往注册"}),(0,k.jsx)(r.Z,{type:"link",className:w.backBtn,onClick:function(){re("/home")},children:"返回首页"}),(0,k.jsx)(r.Z,{type:"link",className:w.forgetBtn,onClick:function(){i(!0)},children:"忘记密码"})]})]})})})}}}]);